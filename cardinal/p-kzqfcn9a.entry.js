import{r as t,g as e,h as r}from"./p-bd5842d7.js";import{C as s}from"./p-bd9d7655.js";import{e as i,s as n,T as l}from"./p-e4951b40.js";const o=class{constructor(e){t(this,e),this.chapterList=[]}connectedCallback(){this.pskPageElement=i(e(this),"psk-page")}tocReceived(t){t.detail&&(this.chapterList=this._sortChapters([...t.detail]))}_sortCurrentChapter(t,e){if(0===t.children.length)return t;let r=[];for(let s=0;s<e.length;++s){let i=t.children.find(t=>t.guid===e[s]);i&&(e.splice(s--,1),r.push(this._sortCurrentChapter(i,e)))}return Object.assign({},t,{children:r})}_sortChapters(t){const e=this.pskPageElement.querySelectorAll("psk-chapter"),r=e.filter(t=>!(t.hasAttribute("data-define-props")||t.hasAttribute("data-define-events")||t.hasAttribute("data-define-controller"))&&t.hasAttribute("guid")).map(t=>t.getAttribute("guid"));e.forEach(t=>{t.hasAttribute("data-define-props")||t.hasAttribute("data-define-controller")||t.hasAttribute("data-define-events")||!t.hasAttribute("guid")||r.push(t.getAttribute("guid"))});let s=[];for(let e=0;e<r.length;++e){let i=t.find(t=>t.guid===r[e]);i&&(r.splice(e--,1),s.push(this._sortCurrentChapter(i,r)))}return s}_renderChapters(t,e,s){return e.map((e,i)=>{let l=void 0===s?`${i+1}.`:`${s}${i+1}.`;return r("li",{onClick:r=>{r.stopImmediatePropagation(),r.preventDefault(),n(e.title,t)}},r("span",null,`${l} ${e.title}`),0===e.children.length?null:r("ul",null,this._renderChapters(t,e.children,l)))})}render(){return r("div",{class:"table-of-content"},r("psk-card",{title:this.title},r("ul",null,this._renderChapters(this.pskPageElement,this.chapterList))))}};!function(t,e,r,s){var i,n=arguments.length,l=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,r):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,r,s);else for(var o=t.length-1;o>=0;o--)(i=t[o])&&(l=(n<3?i(l):n>3?i(e,r,l):i(e,r))||l);n>3&&l&&Object.defineProperty(e,r,l)}([s(),l({description:"This property is the title of the psk-card that will be created",isMandatory:!1,propertyType:"string"})],o.prototype,"title",void 0);export{o as psk_toc};