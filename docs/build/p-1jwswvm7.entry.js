import{g as e,r as t,c as s,h as a}from"./p-8ea06cdd.js";const o={basePagesUrl:globalConfig.pagesBasePath?globalConfig.pagesBasePath:"https://raw.githubusercontent.com/PrivateSky/pwc-apps/master/pages/",defaultPageProp:{icon:"fa-bars",type:"route",component:"psk-page-loader",exact:!0},profile:{username:"PrivateSky",email:"privatesky@axiologic.net",avatar:"https://privatesky.xyz/assets/icon/privatesky.png"}},n=[{name:"PSK Components",path:"/psk-components",icon:"fa-bars",type:"abstract",children:[{name:"App Menu",path:"/psk-components/app-menu",component:"app-menu-usage",icon:"fa-bars",type:"route",exact:!0},{name:"App Router",component:"app-router-usage",path:"/psk-components/app-router",icon:"fa-bars",type:"route",exact:!0},{name:"Attachments List",component:"attachment-list-usage",path:"/psk-components/attach-list",icon:"fa-bars",type:"route",exact:!0},{name:"Files Chooser",component:"files-chooser-usage",path:"/psk-components/files-chooser",icon:"fa-bars",type:"route",exact:!0},{name:"Modal",component:"modal-usage",path:"/psk-components/modal",icon:"fa-bars",type:"route",exact:!0},{name:"PIN Popup",component:"pin-popup-usage",path:"/psk-components/pin-popup",icon:"fa-bars",type:"route",exact:!0},{name:"UI Loader",component:"ui-loader-usage",path:"/psk-components/ui-loader",icon:"fa-bars",type:"route",exact:!0},{name:"User Profile",path:"/psk-components/user-profile",icon:"fa-bars",type:"route",component:"user-profile-usage",exact:!0},{name:"Feedback List",path:"/psk-components/list-feedback",icon:"fa-bars",type:"route",component:"feedback-list-usage",exact:!0},{name:"Wizard",path:"/psk-components/wizard",icon:"fa-bars",type:"route",component:"wizard-usage",exact:!0}]}],p=[{stepName:"Name your CSB",stepIndex:0,stepComponent:"enter-csb-name"},{stepName:"Select CSB type(s)",stepIndex:1,stepComponent:"select-csb-type"},{stepName:"Save recovery Phrase",stepIndex:2,stepComponent:"save-recovery-phrase"},{stepName:"Finish",stepIndex:3,stepComponent:"finish-page"}],i=o.basePagesUrl+"pages-structure.json";class r{constructor(t){this.element=e(t),this.openFeedbackRequest=null;let s=JSON.parse(JSON.stringify(n));this._fetchPagesStructure(s),this.element.addEventListener("menuEvent",e=>{e.stopImmediatePropagation(),"href"===e.detail.type&&(window.location.href=e.detail.path);let t=new CustomEvent("routeChanged",{bubbles:!0,cancelable:!1,detail:e.detail});this.element.dispatchEvent(t)}),this.element.addEventListener("needMenuItems",e=>{e.stopImmediatePropagation();let t=e.detail;if(t&&"function"==typeof t){let e=setInterval(()=>{this.pagesStructure&&(t(this.pagesStructure),s())},100),s=()=>{clearInterval(e)}}else console.error("Callback was not properly provided!")}),this.element.addEventListener("validateUrl",e=>{e.stopImmediatePropagation();let{sourceUrl:t,callback:s}=e.detail;s&&"function"==typeof s?this._parseSourceUrl(t,s):console.error("Callback was not properly provided!")}),this.element.addEventListener("getUserInfo",e=>{let t=e.detail;t&&"function"==typeof t?t(null,o.profile):console.error("Callback was not properly provided!")}),this.element.addEventListener("needWizardConfiguration",e=>{let t=e.detail;t&&"function"==typeof t?t(p):console.error("Callback was not properly provided!")}),this.element.addEventListener("changeStep",e=>{let t=e.detail.callback;t&&"function"==typeof t?this._handleChangeStep(e.detail):console.error("Callback was not properly provided!")}),this.element.addEventListener("openFeedback",e=>{this.openFeedbackRequest=e.detail}),this.element.addEventListener("showFeedback",e=>{this.openFeedbackRequest(e.detail.message,e.detail.name,e.detail.type)}),this.element.addEventListener("sendPin",e=>{let t=e.detail.callback;t&&"function"==typeof t?this._handleSendPin(e.detail):console.error("Callback was not properly provided!")})}_parseSourceUrl(e,t){let s="",a=!1,o=!1,n=JSON.parse(JSON.stringify(this.pagesStructure)),p=e.split("/").map(e=>e.replace(/(\s+|:+|\/+)/g,"").toLowerCase());p.forEach((i,r)=>{if(o)return;if(0===n.length)return t(`${e} is not a valid path in the application!`),void(o=!0);s=`${s}${i}`;let l=n.find(e=>{let t=e.path.replace(/(\s+|:+|\/+|-+)/g,"").toLowerCase(),a=e.name.replace(/(\s+|:+|\/+|-+)/g,"").toLowerCase();return i===a||s===t});return l?r===p.length-1&&"route"===l.type?(t(null,l.path),void(a=!0)):void(n=l.hasOwnProperty("children")?l.children:[]):(t(`${e} is not a valid path in the application!`),void(o=!0))}),a||o||t(`${e} is not a valid path in the application!`)}_handleSendPin({pin:e,callback:t}){!e||e.trim().length<6?t("Invalid PIN length. Minimum is 6!"):(console.log(e),t(null))}__getPropertyValue(e,t){return e.stepProperties&&e.stepProperties.hasOwnProperty(t)?e.stepProperties[t]:null}_handleChangeStep(e){let t=e.stepIndexToDisplay,s=e.callback,a=e.wizardSteps,o=e.activeStep,n=null;if(t<0||t>=a.length)n="Index has no valid value";else if(t<=o.stepIndex)a[o.stepIndex]={...o},o={...a[t]};else switch(o.stepProperties.stepPhase){case"csb-name":{const e=this.__getPropertyValue(o,"csbName");null===e||0===e.trim().length?n="CSB Name is empty":(o.stepCompleted=!0,a[o.stepIndex]={...o},o={...a[t]});break}case"csb-type":{const e=this.__getPropertyValue(o,"csbType");null===e||0===e.trim().length?n="CSB Type is empty":(o.stepCompleted=!0,a[o.stepIndex]={...o},o={...a[t]});break}case"save-recovery-phrase":null===this.__getPropertyValue(o,"saveRecoveryPhrase")?n="Recovery phase property is not sent":(o.stepCompleted=!0,a[o.stepIndex]={...o},o={...a[t]})}s(n,{activeStep:o,wizardSteps:a})}_fetchPagesStructure(e){let t=new XMLHttpRequest;t.open("GET",i),t.onload=()=>{if(200!=t.status)this._prepareNavigationStructure(e);else{let s=JSON.parse(t.responseText);this._fillOptionalProps(s);let a=e.map(e=>e.name);s.forEach((t,o)=>{if(t.parent>-1){let n=a.indexOf(t.parent);n&&(e[n].children||(e[n].children=[]),t.path=e[n].path+t.path,e[n].children.push(t),s.splice(o,1))}}),this._prepareNavigationStructure(s.concat(e))}},t.onerror=()=>{this._prepareNavigationStructure(e)},t.send()}_prepareNavigationStructure(e){this.pagesStructure=JSON.parse(JSON.stringify(e))}_fillOptionalProps(e,t){e.forEach(e=>{if(!e.path){let t=e.name.toLowerCase().toLowerCase().replace(/\s+/g,"-");t=t.replace(/[:\/]/g,""),e.path=t}if(t&&(e.path=t+"/"+e.path),e.children)e.type="abstract",e.icon||(e.icon=o.defaultPageProp.icon);else{for(let t in o.defaultPageProp)e[t]||(e[t]=o.defaultPageProp[t]);if("psk-page-loader"===e.component)if(e.componentProps||(e.componentProps={}),e.pageSrc)e.componentProps.pageUrl=o.basePagesUrl+e.pageSrc;else{let s=e.name.replace(/\s(.)/g,(function(e){return e.toUpperCase()})).replace(/\s/g,""),a=t.replace(/^\//,"");e.componentProps.pageUrl=o.basePagesUrl+a+"/"+s+".html"}}e.children&&this._fillOptionalProps(e.children,e.path)})}}const l=class{constructor(e){t(this,e),this.mobileLayout=!1,this.controller||(this.controller=new r(this)),this.routeChangedEvent=s(this,"routeChanged",7)}checkLayout(){this.mobileLayout=document.documentElement.clientWidth<650}componentWillLoad(){this.checkLayout()}render(){return a("div",{class:`global_container ${this.mobileLayout?"is-mobile":""}`},a("aside",null,a("psk-user-profile",null),a("app-menu",{"item-renderer":"sidebar-renderer",hamburgerMaxWidth:650}," "),!1===this.mobileLayout?a("div",{class:"nav-footer"},"version 0.1"):null),a("section",null,a("psk-app-router",{failRedirectTo:"/home",historyType:"hash"}," "),!0===this.mobileLayout?a("div",{class:"nav-footer bottom-stick"},"version 0.1"):null))}static get style(){return"div.global_container{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:start;justify-content:flex-start;height:100%;background-color:#f8f9fc}div.global_container.is-mobile{width:100%;-ms-flex-direction:column;flex-direction:column}.is-mobile aside{width:100%;height:auto;overflow:inherit}aside{height:100%;background-color:#4e73df;background-image:-webkit-gradient(linear,left top,left bottom,color-stop(10%,#4e73df),to(#224abe));background-image:linear-gradient(180deg,#4e73df 10%,#224abe);color:#fff;-ms-flex-align:center;align-items:center;-webkit-box-shadow:0 2px 5px 0 rgba(0,0,0,.26);box-shadow:0 2px 5px 0 rgba(0,0,0,.26);-ms-flex-order:1;order:1;-ms-flex:1;flex:1;min-width:320px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow:auto;scrollbar-color:#4e73df #e5e5e5;scrollbar-width:thin}.nav-footer{text-align:center;width:100%;padding:10px;-webkit-box-sizing:border-box;box-sizing:border-box;background:#142b86;font-size:85%}.nav-footer.bottom-stick{color:#fff;background:#224abe}section{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;height:100%;overflow:hidden auto;scrollbar-color:#4e73df #e5e5e5;scrollbar-width:thin}app-menu,psk-app-router{-ms-flex-positive:1;flex-grow:1}psk-user-profile{-ms-flex-direction:column;flex-direction:column}h1{font-size:1.4rem;font-weight:500;color:#fff;padding:0 12px}section{-ms-flex-order:2;order:2;-ms-flex:8;flex:8}aside::-webkit-scrollbar,section::-webkit-scrollbar{background-color:#fff;width:8px}aside::-webkit-scrollbar-track,section::-webkit-scrollbar-track{background-color:#e5e5e5}aside::-webkit-scrollbar-thumb,section::-webkit-scrollbar-thumb{background-color:#4e73df;border-radius:8px;border:2px solid #fff}aside::-webkit-scrollbar-button{display:none}"}};export{l as app_root};